{
	"name": "CVE-2024-26813",
	"description": "In the Linux kernel, the following vulnerability has been resolved:vfio/platform: Create persistent IRQ handlersThe vfio-platform SET_IRQS ioctl currently allows loopback triggering ofan interrupt before a signaling eventfd has been configured by the user,which thereby allows a NULL pointer dereference.Rather than register the IRQ relative to a valid trigger, register allIRQs in a disabled state in the device open path.  This allows maskoperations on the IRQ to nest within the overall enable state governedby a valid eventfd signal.  This decouples @masked, protected by the@locked spinlock from @trigger, protected via the @igate mutex.In doing so, it's guaranteed that changes to @trigger cannot race theIRQ handlers because the IRQ handler is synchronously disabled beforemodifying the trigger, and loopback triggering of the IRQ via ioctl issafe due to serialization with trigger changes via igate.For compatibility, request_irq() failures are maintained to be local tothe SET_IRQS ioctl rather than a fatal error in the open device path.This allows, for example, a userspace driver with polling mode supportto continue to work regardless of moving the request_irq() call site.This necessarily blocks all SET_IRQS access to the failed index.",
	"type": "none",
	"severity": "medium",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/07afdfd8a68f9eea8db0ddc4626c874f29d2ac5e",
		"https://git.kernel.org/stable/c/09452c8fcbd7817c06e8e3212d99b45917e603a5",
		"https://git.kernel.org/stable/c/0f8d8f9c2173a541812dd750529f4a415117eb29",
		"https://git.kernel.org/stable/c/62d4e43a569b67929eb3319780be5359694c8086",
		"https://git.kernel.org/stable/c/675daf435e9f8e5a5eab140a9864dfad6668b375",
		"https://git.kernel.org/stable/c/7932db06c82c5b2f42a4d1a849d97dba9ce4a362",
		"https://git.kernel.org/stable/c/cc5838f19d39a5fef04c468199699d2a4578be3a",
		"https://git.kernel.org/stable/c/d6bedd6acc0bcb1e7e010bc046032e47f08d379f"
	],
	"datetime": "2024-04-13 00:00:00",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		},
		{
			"name": "photonos",
			"version": "4",
			"vendor": "photonos-4"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "\u003c 0:6.1.85-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 0:5.10.216-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux",
			"version": "\u003c 5.10.216-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux",
			"version": "\u003c 6.7.12-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		},
		{
			"name": "linux",
			"version": "\u003c 6.1.85-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 5.10.216-1.ph4",
			"architecture": "any",
			"manager": "tdnf",
			"vendor": "photon-4"
		}
	],
	"products": [],
	"programs": [],
	"weaknesses": []
}