{
	"name": "CVE-2024-57841",
	"description": "In the Linux kernel, the following vulnerability has been resolved:net: fix memory leak in tcp_conn_request()If inet_csk_reqsk_queue_hash_add() return false, tcp_conn_request() willreturn without free the dst memory, which allocated in af_ops-\u003eroute_req.Here is the kmemleak stack:unreferenced object 0xffff8881198631c0 (size 240):  comm \"softirq\", pid 0, jiffies 4299266571 (age 1802.392s)  hex dump (first 32 bytes):    00 10 9b 03 81 88 ff ff 80 98 da bc ff ff ff ff  ................    81 55 18 bb ff ff ff ff 00 00 00 00 00 00 00 00  .U..............  backtrace:    [\u003cffffffffb93e8d4c\u003e] kmem_cache_alloc+0x60c/0xa80    [\u003cffffffffba11b4c5\u003e] dst_alloc+0x55/0x250    [\u003cffffffffba227bf6\u003e] rt_dst_alloc+0x46/0x1d0    [\u003cffffffffba23050a\u003e] __mkroute_output+0x29a/0xa50    [\u003cffffffffba23456b\u003e] ip_route_output_key_hash+0x10b/0x240    [\u003cffffffffba2346bd\u003e] ip_route_output_flow+0x1d/0x90    [\u003cffffffffba254855\u003e] inet_csk_route_req+0x2c5/0x500    [\u003cffffffffba26b331\u003e] tcp_conn_request+0x691/0x12c0    [\u003cffffffffba27bd08\u003e] tcp_rcv_state_process+0x3c8/0x11b0    [\u003cffffffffba2965c6\u003e] tcp_v4_do_rcv+0x156/0x3b0    [\u003cffffffffba299c98\u003e] tcp_v4_rcv+0x1cf8/0x1d80    [\u003cffffffffba239656\u003e] ip_protocol_deliver_rcu+0xf6/0x360    [\u003cffffffffba2399a6\u003e] ip_local_deliver_finish+0xe6/0x1e0    [\u003cffffffffba239b8e\u003e] ip_local_deliver+0xee/0x360    [\u003cffffffffba239ead\u003e] ip_rcv+0xad/0x2f0    [\u003cffffffffba110943\u003e] __netif_receive_skb_one_core+0x123/0x140Call dst_release() to free the dst memory wheninet_csk_reqsk_queue_hash_add() return false in tcp_conn_request().",
	"type": "none",
	"severity": "medium",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/2af69905180b3fea12f9c1db374b153a06977021",
		"https://git.kernel.org/stable/c/4f4aa4aa28142d53f8b06585c478476cfe325cfc",
		"https://git.kernel.org/stable/c/9d38959677291552d1b0ed2689a540af279b5bf8",
		"https://git.kernel.org/stable/c/b0b190218c78d8aeecfba36ea3a90063b3ede52d",
		"https://git.kernel.org/stable/c/de3f999bf8aee16e9da1c1224191abdc69e97c9d"
	],
	"datetime": "2025-02-06 12:35:28",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		},
		{
			"name": "photonos",
			"version": "5",
			"vendor": "photonos-5"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 5.10.223-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux",
			"version": "\u003c 6.12.9-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		},
		{
			"name": "linux",
			"version": "\u003c 6.1.124-1.ph5",
			"architecture": "any",
			"manager": "tdnf",
			"vendor": "photon-5"
		}
	],
	"products": [
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 5.15.176",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.1.124",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.6.70",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.12.9",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.13-rc1",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.13-rc2",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.13-rc3",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.13-rc4",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.13-rc5",
			"type": "system"
		}
	],
	"programs": [],
	"weaknesses": [
		{
			"name": "CWE-401",
			"impact": "any",
			"scope": "any"
		}
	]
}