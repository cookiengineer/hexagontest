{
	"name": "CVE-2024-53123",
	"description": "In the Linux kernel, the following vulnerability has been resolved:mptcp: error out earlier on disconnectEric reported a division by zero splat in the MPTCP protocol:Oops: divide error: 0000 [#1] PREEMPT SMP KASAN PTICPU: 1 UID: 0 PID: 6094 Comm: syz-executor317 Not tainted6.12.0-rc5-syzkaller-00291-g05b92660cdfe #0Hardware name: Google Google Compute Engine/Google Compute Engine,BIOS Google 09/13/2024RIP: 0010:__tcp_select_window+0x5b4/0x1310 net/ipv4/tcp_output.c:3163Code: f6 44 01 e3 89 df e8 9b 75 09 f8 44 39 f3 0f 8d 11 ff ff ff e80d 74 09 f8 45 89 f4 e9 04 ff ff ff e8 00 74 09 f8 44 89 f0 99 \u003cf7\u003e 7c24 14 41 29 d6 45 89 f4 e9 ec fe ff ff e8 e8 73 09 f8 48 89RSP: 0018:ffffc900041f7930 EFLAGS: 00010293RAX: 0000000000017e67 RBX: 0000000000017e67 RCX: ffffffff8983314bRDX: 0000000000000000 RSI: ffffffff898331b0 RDI: 0000000000000004RBP: 00000000005d6000 R08: 0000000000000004 R09: 0000000000017e67R10: 0000000000003e80 R11: 0000000000000000 R12: 0000000000003e80R13: ffff888031d9b440 R14: 0000000000017e67 R15: 00000000002eb000FS: 00007feb5d7f16c0(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033CR2: 00007feb5d8adbb8 CR3: 0000000074e4c000 CR4: 00000000003526f0DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400Call Trace:\u003cTASK\u003e__tcp_cleanup_rbuf+0x3e7/0x4b0 net/ipv4/tcp.c:1493mptcp_rcv_space_adjust net/mptcp/protocol.c:2085 [inline]mptcp_recvmsg+0x2156/0x2600 net/mptcp/protocol.c:2289inet_recvmsg+0x469/0x6a0 net/ipv4/af_inet.c:885sock_recvmsg_nosec net/socket.c:1051 [inline]sock_recvmsg+0x1b2/0x250 net/socket.c:1073__sys_recvfrom+0x1a5/0x2e0 net/socket.c:2265__do_sys_recvfrom net/socket.c:2283 [inline]__se_sys_recvfrom net/socket.c:2279 [inline]__x64_sys_recvfrom+0xe0/0x1c0 net/socket.c:2279do_syscall_x64 arch/x86/entry/common.c:52 [inline]do_syscall_64+0xcd/0x250 arch/x86/entry/common.c:83entry_SYSCALL_64_after_hwframe+0x77/0x7fRIP: 0033:0x7feb5d857559Code: 28 00 00 00 75 05 48 83 c4 28 c3 e8 51 18 00 00 90 48 89 f8 4889 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 \u003c48\u003e 3d01 f0 ff ff 73 01 c3 48 c7 c1 b0 ff ff ff f7 d8 64 89 01 48RSP: 002b:00007feb5d7f1208 EFLAGS: 00000246 ORIG_RAX: 000000000000002dRAX: ffffffffffffffda RBX: 00007feb5d8e1318 RCX: 00007feb5d857559RDX: 000000800000000e RSI: 0000000000000000 RDI: 0000000000000003RBP: 00007feb5d8e1310 R08: 0000000000000000 R09: ffffffff81000000R10: 0000000000000100 R11: 0000000000000246 R12: 00007feb5d8e131cR13: 00007feb5d8ae074 R14: 000000800000000e R15: 00000000fffffdefand provided a nice reproducer.The root cause is the current bad handling of racing disconnect.After the blamed commit below, sk_wait_data() can return (witherror) with the underlying socket disconnected and a zero rcv_mss.Catch the error and return without performing any additionaloperations on the current socket.",
	"type": "none",
	"severity": "none",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/581302298524e9d77c4c44ff5156a6cd112227ae",
		"https://git.kernel.org/stable/c/955388e1d5d222c4101c596b536d41b91a8b212e",
		"https://git.kernel.org/stable/c/a66805c9b22caf4e42af7a616f6c6b83c90d1010",
		"https://git.kernel.org/stable/c/a749b23059b43a9b1787eb36c5d9d44150a34238"
	],
	"datetime": "2025-02-06 12:35:25",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "\u003c 0:6.1.119-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux-6.1",
			"version": "\u003c 0:6.1.119-1~deb11u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux-6.1",
			"version": "\u003c 6.1.119-1~deb11u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux",
			"version": "\u003c 6.1.119-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 5.10.223-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux",
			"version": "\u003c 6.11.10-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		}
	],
	"products": [
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.1.119",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.6",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.6.63",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.11.10",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc1",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc2",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc3",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc4",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc5",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc6",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc7",
			"type": "system"
		}
	],
	"programs": [],
	"weaknesses": [
		{
			"name": "CWE-362",
			"impact": "any",
			"scope": "any"
		}
	]
}