{
	"name": "CVE-2024-56672",
	"description": "In the Linux kernel, the following vulnerability has been resolved:blk-cgroup: Fix UAF in blkcg_unpin_online()blkcg_unpin_online() walks up the blkcg hierarchy putting the online pin. Towalk up, it uses blkcg_parent(blkcg) but it was calling that afterblkcg_destroy_blkgs(blkcg) which could free the blkcg, leading to thefollowing UAF:  ==================================================================  BUG: KASAN: slab-use-after-free in blkcg_unpin_online+0x15a/0x270  Read of size 8 at addr ffff8881057678c0 by task kworker/9:1/117  CPU: 9 UID: 0 PID: 117 Comm: kworker/9:1 Not tainted 6.13.0-rc1-work-00182-gb8f52214c61a-dirty #48  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS unknown 02/02/2022  Workqueue: cgwb_release cgwb_release_workfn  Call Trace:   \u003cTASK\u003e   dump_stack_lvl+0x27/0x80   print_report+0x151/0x710   kasan_report+0xc0/0x100   blkcg_unpin_online+0x15a/0x270   cgwb_release_workfn+0x194/0x480   process_scheduled_works+0x71b/0xe20   worker_thread+0x82a/0xbd0   kthread+0x242/0x2c0   ret_from_fork+0x33/0x70   ret_from_fork_asm+0x1a/0x30   \u003c/TASK\u003e  ...  Freed by task 1944:   kasan_save_track+0x2b/0x70   kasan_save_free_info+0x3c/0x50   __kasan_slab_free+0x33/0x50   kfree+0x10c/0x330   css_free_rwork_fn+0xe6/0xb30   process_scheduled_works+0x71b/0xe20   worker_thread+0x82a/0xbd0   kthread+0x242/0x2c0   ret_from_fork+0x33/0x70   ret_from_fork_asm+0x1a/0x30Note that the UAF is not easy to trigger as the free path is indirectedbehind a couple RCU grace periods and a work item execution. I could onlytrigger it with artifical msleep() injected in blkcg_unpin_online().Fix it by reading the parent pointer before destroying the blkcg's blkg's.",
	"type": "none",
	"severity": "high",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/29d1e06560f0f6179062ac638b4064deb637d1ad",
		"https://git.kernel.org/stable/c/5baa28569c924d9a90d036c2aaab79f791fedaf8",
		"https://git.kernel.org/stable/c/64afc6fe24c9896c0153e5a199bcea241ecb0d5c",
		"https://git.kernel.org/stable/c/86e6ca55b83c575ab0f2e105cf08f98e58d3d7af",
		"https://git.kernel.org/stable/c/8a07350fe070017a887433f4d6909433955be5f1"
	],
	"datetime": "2024-12-11 07:24:35",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		},
		{
			"name": "cblmariner",
			"version": "2",
			"vendor": "cblmariner-2"
		},
		{
			"name": "photonos",
			"version": "5",
			"vendor": "photonos-5"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "\u003c 0:6.1.123-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux",
			"version": "\u003c 6.12.6-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		},
		{
			"name": "linux",
			"version": "\u003c 6.1.123-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "kernel",
			"version": "\u003c 0:5.15.173.1-1.",
			"architecture": "any",
			"manager": "apt",
			"vendor": "cblmariner-2"
		},
		{
			"name": "linux",
			"version": "\u003c 6.1.124-1.ph5",
			"architecture": "any",
			"manager": "tdnf",
			"vendor": "photon-5"
		}
	],
	"products": [
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.1.121",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.6.67",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.12.6",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.13-rc1",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.13-rc2",
			"type": "system"
		}
	],
	"programs": [],
	"weaknesses": [
		{
			"name": "CWE-416",
			"impact": "any",
			"scope": "any"
		}
	]
}