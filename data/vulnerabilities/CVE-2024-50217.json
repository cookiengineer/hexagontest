{
	"name": "CVE-2024-50217",
	"description": "In the Linux kernel, the following vulnerability has been resolved:btrfs: fix use-after-free of block device file in __btrfs_free_extra_devids()Mounting btrfs from two images (which have the same one fsid and twodifferent dev_uuids) in certain executing order may trigger an UAF forvariable 'device-\u003ebdev_file' in __btrfs_free_extra_devids(). Andfollowing are the details:1. Attach image_1 to loop0, attach image_2 to loop1, and scan btrfs   devices by ioctl(BTRFS_IOC_SCAN_DEV):             /  btrfs_device_1  loop0   fs_device             \\  btrfs_device_2  loop12. mount /dev/loop0 /mnt   btrfs_open_devices    btrfs_device_1-\u003ebdev_file = btrfs_get_bdev_and_sb(loop0)    btrfs_device_2-\u003ebdev_file = btrfs_get_bdev_and_sb(loop1)   btrfs_fill_super    open_ctree     fail: btrfs_close_devices // -ENOMEM        btrfs_close_bdev(btrfs_device_1)             fput(btrfs_device_1-\u003ebdev_file)          // btrfs_device_1-\u003ebdev_file is freed        btrfs_close_bdev(btrfs_device_2)             fput(btrfs_device_2-\u003ebdev_file)3. mount /dev/loop1 /mnt   btrfs_open_devices    btrfs_get_bdev_and_sb(\u0026bdev_file)     // EIO, btrfs_device_1-\u003ebdev_file is not assigned,     // which points to a freed memory area    btrfs_device_2-\u003ebdev_file = btrfs_get_bdev_and_sb(loop1)   btrfs_fill_super    open_ctree     btrfs_free_extra_devids      if (btrfs_device_1-\u003ebdev_file)       fput(btrfs_device_1-\u003ebdev_file) // UAF !Fix it by setting 'device-\u003ebdev_file' as 'NULL' after closing thebtrfs_device in btrfs_close_one_device().",
	"type": "none",
	"severity": "none",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/47a83f8df39545f3f552bb6a1b6d9c30e37621dd",
		"https://git.kernel.org/stable/c/aec8e6bf839101784f3ef037dcdb9432c3f32343"
	],
	"datetime": "2025-02-06 12:35:23",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 6.11.7-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		}
	],
	"products": [
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.11.7",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc1",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc2",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc3",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc4",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc5",
			"type": "system"
		}
	],
	"programs": [],
	"weaknesses": [
		{
			"name": "CWE-416",
			"impact": "any",
			"scope": "any"
		}
	]
}