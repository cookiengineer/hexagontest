{
	"name": "CVE-2024-9681",
	"description": "When curl is asked to use HSTS, the expiry time for a subdomain mightoverwrite a parent domain's cache entry, making it end sooner or later thanotherwise intended.This affects curl using applications that enable HSTS and use URLs with theinsecure 'HTTP://' scheme and perform transfers with hosts like'x.example.com' as well as 'example.com' where the first host is a subdomainof the second host.(The HSTS cache either needs to have been populated manually or there needs tohave been previous HTTPS accesses done as the cache needs to have entries forthe domains involved to trigger this problem.)When 'x.example.com' responds with 'Strict-Transport-Security:' headers, thisbug can make the subdomain's expiry timeout *bleed over* and get set for theparent domain 'example.com' in curl's HSTS cache.The result of a triggered bug is that HTTP accesses to 'example.com' getconverted to HTTPS for a different period of time than what was asked for bythe origin server. If 'example.com' for example stops supporting HTTPS at itsexpiry time, curl might then fail to access 'http://example.com' until the(wrongly set) timeout expires. This bug can also expire the parent's entry*earlier*, thus making curl inadvertently switch back to insecure HTTP earlierthan otherwise intended.",
	"type": "none",
	"severity": "medium",
	"state": "published",
	"references": [
		"https://curl.se/docs/CVE-2024-9681.html",
		"https://curl.se/docs/CVE-2024-9681.json",
		"https://hackerone.com/reports/2764830",
		"http://www.openwall.com/lists/oss-security/2024/11/06/2",
		"https://security.netapp.com/advisory/ntap-20241213-0006/",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-9681.html",
		"https://access.redhat.com/security/cve/CVE-2024-9681",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-9681"
	],
	"datetime": "2025-01-04 08:04:00",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "alpinelinux",
			"version": "3.17",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "alpinelinux",
			"version": "3.18",
			"vendor": "alpinelinux-3.18"
		},
		{
			"name": "amazonlinux",
			"version": "2",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "cblmariner",
			"version": "2",
			"vendor": "cblmariner-2"
		},
		{
			"name": "photonos",
			"version": "3",
			"vendor": "photonos-3"
		},
		{
			"name": "photonos",
			"version": "4",
			"vendor": "photonos-4"
		},
		{
			"name": "photonos",
			"version": "5",
			"vendor": "photonos-5"
		}
	],
	"packages": [
		{
			"name": "curl",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "curl",
			"version": "\u003c 8.11.0-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-trixie"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.10.1",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.10.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.9.1",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.9.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.8.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.7.1",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.7.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.6.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.5.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.4.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.3.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.2.1",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.2.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.1.2",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.1.1",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.1.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.0.1",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 8.0.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.88.1",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.88.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.87.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.86.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.85.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.84.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.83.1",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.83.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.82.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.81.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.80.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.79.1",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.79.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.78.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.77.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.76.1",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.76.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.75.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c= 7.74.0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "curl",
			"version": "\u003c 8.3.0.1.amzn2.0.8",
			"architecture": "armv8",
			"manager": "any",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "libcurl",
			"version": "\u003c 8.3.0.1.amzn2.0.8",
			"architecture": "armv8",
			"manager": "any",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "libcurl-devel",
			"version": "\u003c 8.3.0.1.amzn2.0.8",
			"architecture": "armv8",
			"manager": "any",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "curl-debuginfo",
			"version": "\u003c 8.3.0.1.amzn2.0.8",
			"architecture": "armv8",
			"manager": "any",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "curl",
			"version": "\u003c 8.3.0.1.amzn2.0.8",
			"architecture": "x86",
			"manager": "any",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "libcurl",
			"version": "\u003c 8.3.0.1.amzn2.0.8",
			"architecture": "x86",
			"manager": "any",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "libcurl-devel",
			"version": "\u003c 8.3.0.1.amzn2.0.8",
			"architecture": "x86",
			"manager": "any",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "curl-debuginfo",
			"version": "\u003c 8.3.0.1.amzn2.0.8",
			"architecture": "x86",
			"manager": "any",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "curl",
			"version": "\u003c 8.3.0.1.amzn2.0.8",
			"architecture": "any",
			"manager": "any",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "curl",
			"version": "\u003c 8.3.0.1.amzn2.0.8",
			"architecture": "x86_64",
			"manager": "any",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "libcurl",
			"version": "\u003c 8.3.0.1.amzn2.0.8",
			"architecture": "x86_64",
			"manager": "any",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "libcurl-devel",
			"version": "\u003c 8.3.0.1.amzn2.0.8",
			"architecture": "x86_64",
			"manager": "any",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "curl-debuginfo",
			"version": "\u003c 8.3.0.1.amzn2.0.8",
			"architecture": "x86_64",
			"manager": "any",
			"vendor": "amazonlinux-2"
		},
		{
			"name": "cmake",
			"version": "\u003c 0:3.21.4-16.",
			"architecture": "any",
			"manager": "apt",
			"vendor": "cblmariner-2"
		},
		{
			"name": "curl",
			"version": "\u003c 8.1.2-9.ph3",
			"architecture": "any",
			"manager": "tdnf",
			"vendor": "photon-3"
		},
		{
			"name": "curl",
			"version": "\u003c 8.7.1-4.ph4",
			"architecture": "any",
			"manager": "tdnf",
			"vendor": "photon-4"
		},
		{
			"name": "curl",
			"version": "\u003c 8.7.1-4.ph5",
			"architecture": "any",
			"manager": "tdnf",
			"vendor": "photon-5"
		}
	],
	"products": [
		{
			"name": "haxx:curl",
			"vendor": "haxx",
			"product": "curl",
			"version": "\u003c 8.11.0",
			"type": "software"
		}
	],
	"programs": [],
	"weaknesses": [
		{
			"name": "CWE-697",
			"impact": "any",
			"scope": "any"
		}
	]
}