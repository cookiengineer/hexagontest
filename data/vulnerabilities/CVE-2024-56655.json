{
	"name": "CVE-2024-56655",
	"description": "In the Linux kernel, the following vulnerability has been resolved:netfilter: nf_tables: do not defer rule destruction via call_rcunf_tables_chain_destroy can sleep, it can't be used from call_rcucallbacks.Moreover, nf_tables_rule_release() is only safe for error unwinding,while transaction mutex is held and the to-be-desroyed rule was notexposed to either dataplane or dumps, as it deactives+frees withoutthe required synchronize_rcu() in-between.nft_rule_expr_deactivate() callbacks will change -\u003euse countersof other chains/sets, see e.g. nft_lookup .deactivate callback, thesemust be serialized via transaction mutex.Also add a few lockdep asserts to make this more explicit.Calling synchronize_rcu() isn't ideal, but fixing this without is hardand way more intrusive.  As-is, we can get:WARNING: .. net/netfilter/nf_tables_api.c:5515 nft_set_destroy+0x..Workqueue: events nf_tables_trans_destroy_workRIP: 0010:nft_set_destroy+0x3fe/0x5c0Call Trace: \u003cTASK\u003e nf_tables_trans_destroy_work+0x6b7/0xad0 process_one_work+0x64a/0xce0 worker_thread+0x613/0x10d0In case the synchronize_rcu becomes an issue, we can explore alternatives.One way would be to allocate nft_trans_rule objects + one nft_trans_chainobject, deactivate the rules + the chain and then defer the freeing to thenft destroy workqueue.  We'd still need to keep the synchronize_rcu path asa fallback to handle -ENOMEM corner cases though.",
	"type": "none",
	"severity": "none",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/27f0574253f6c24c8ee4e3f0a685b75ed3a256ed",
		"https://git.kernel.org/stable/c/7cf0bd232b565d9852cb25fd094f77254773e048",
		"https://git.kernel.org/stable/c/b04df3da1b5c6f6dc7cdccc37941740c078c4043"
	],
	"datetime": "2025-02-06 12:35:27",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		},
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "\u003c 6.12.6-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		},
		{
			"name": "linux",
			"version": "\u003c 6.1.123-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 5.10.223-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		}
	],
	"products": [
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.6.67",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.12.6",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.13-rc1",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.13-rc2",
			"type": "system"
		}
	],
	"programs": [],
	"weaknesses": [
		{
			"name": "any",
			"impact": "any",
			"scope": "any"
		}
	]
}