{
	"name": "CVE-2024-56668",
	"description": "In the Linux kernel, the following vulnerability has been resolved:iommu/vt-d: Fix qi_batch NULL pointer with nested parent domainThe qi_batch is allocated when assigning cache tag for a domain. Whilefor nested parent domain, it is missed. Hence, when trying to map pagesto the nested parent, NULL dereference occurred. Also, there is potentialmemleak since there is no lock around domain-\u003eqi_batch allocation.To solve it, add a helper for qi_batch allocation, and call it in boththe __cache_tag_assign_domain() and __cache_tag_assign_parent_domain().  BUG: kernel NULL pointer dereference, address: 0000000000000200  #PF: supervisor read access in kernel mode  #PF: error_code(0x0000) - not-present page  PGD 8104795067 P4D 0  Oops: Oops: 0000 [#1] PREEMPT SMP NOPTI  CPU: 223 UID: 0 PID: 4357 Comm: qemu-system-x86 Not tainted 6.13.0-rc1-00028-g4b50c3c3b998-dirty #2632  Call Trace:   ? __die+0x24/0x70   ? page_fault_oops+0x80/0x150   ? do_user_addr_fault+0x63/0x7b0   ? exc_page_fault+0x7c/0x220   ? asm_exc_page_fault+0x26/0x30   ? cache_tag_flush_range_np+0x13c/0x260   intel_iommu_iotlb_sync_map+0x1a/0x30   iommu_map+0x61/0xf0   batch_to_domain+0x188/0x250   iopt_area_fill_domains+0x125/0x320   ? rcu_is_watching+0x11/0x50   iopt_map_pages+0x63/0x100   iopt_map_common.isra.0+0xa7/0x190   iopt_map_user_pages+0x6a/0x80   iommufd_ioas_map+0xcd/0x1d0   iommufd_fops_ioctl+0x118/0x1c0   __x64_sys_ioctl+0x93/0xc0   do_syscall_64+0x71/0x140   entry_SYSCALL_64_after_hwframe+0x76/0x7e",
	"type": "none",
	"severity": "none",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/74536f91962d5f6af0a42414773ce61e653c10ee",
		"https://git.kernel.org/stable/c/ffd774c34774fd4cc0e9cf2976595623a6c3a077"
	],
	"datetime": "2025-02-06 12:35:27",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		},
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "\u003c 5.10.223-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux",
			"version": "\u003c 6.12.6-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		},
		{
			"name": "linux",
			"version": "\u003c 6.1.123-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		}
	],
	"products": [
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.12.6",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.13-rc1",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.13-rc2",
			"type": "system"
		}
	],
	"programs": [],
	"weaknesses": [
		{
			"name": "CWE-401",
			"impact": "any",
			"scope": "any"
		},
		{
			"name": "CWE-476",
			"impact": "any",
			"scope": "any"
		}
	]
}