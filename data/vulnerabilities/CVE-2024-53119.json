{
	"name": "CVE-2024-53119",
	"description": "In the Linux kernel, the following vulnerability has been resolved:virtio/vsock: Fix accept_queue memory leakAs the final stages of socket destruction may be delayed, it is possiblethat virtio_transport_recv_listen() will be called after the accept_queuehas been flushed, but before the SOCK_DONE flag has been set. As a result,sockets enqueued after the flush would remain unremoved, leading to amemory leak.vsock_release  __vsock_release    lock    virtio_transport_release      virtio_transport_close        schedule_delayed_work(close_work)    sk_shutdown = SHUTDOWN_MASK(!) flush accept_queue    release                                        virtio_transport_recv_pkt                                          vsock_find_bound_socket                                          lock                                          if flag(SOCK_DONE) return                                          virtio_transport_recv_listen                                            child = vsock_create_connected                                      (!)   vsock_enqueue_accept(child)                                          releaseclose_work  lock  virtio_transport_do_close    set_flag(SOCK_DONE)    virtio_transport_remove_sock      vsock_remove_sock        vsock_remove_bound  releaseIntroduce a sk_shutdown check to disallow vsock_enqueue_accept() duringsocket destruction.unreferenced object 0xffff888109e3f800 (size 2040):  comm \"kworker/5:2\", pid 371, jiffies 4294940105  hex dump (first 32 bytes):    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................    28 00 0b 40 00 00 00 00 00 00 00 00 00 00 00 00  (..@............  backtrace (crc 9e5f4e84):    [\u003cffffffff81418ff1\u003e] kmem_cache_alloc_noprof+0x2c1/0x360    [\u003cffffffff81d27aa0\u003e] sk_prot_alloc+0x30/0x120    [\u003cffffffff81d2b54c\u003e] sk_alloc+0x2c/0x4b0    [\u003cffffffff81fe049a\u003e] __vsock_create.constprop.0+0x2a/0x310    [\u003cffffffff81fe6d6c\u003e] virtio_transport_recv_pkt+0x4dc/0x9a0    [\u003cffffffff81fe745d\u003e] vsock_loopback_work+0xfd/0x140    [\u003cffffffff810fc6ac\u003e] process_one_work+0x20c/0x570    [\u003cffffffff810fce3f\u003e] worker_thread+0x1bf/0x3a0    [\u003cffffffff811070dd\u003e] kthread+0xdd/0x110    [\u003cffffffff81044fdd\u003e] ret_from_fork+0x2d/0x50    [\u003cffffffff8100785a\u003e] ret_from_fork_asm+0x1a/0x30",
	"type": "none",
	"severity": "medium",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/2415345042245de7601dcc6eafdbe3a3dcc9e379",
		"https://git.kernel.org/stable/c/4310902c766e371359e6c6311056ae80b5beeac9",
		"https://git.kernel.org/stable/c/897617a413e0bf1c6380e3b34b2f28f450508549",
		"https://git.kernel.org/stable/c/946c7600fa2207cc8d3fbc86a518ec56f98a5813",
		"https://git.kernel.org/stable/c/d7b0ff5a866724c3ad21f2628c22a63336deec3f",
		"https://git.kernel.org/stable/c/e26fa236758e8baa61a82cfd9fd4388d2e8d6a4c"
	],
	"datetime": "2025-02-06 12:35:25",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		},
		{
			"name": "photonos",
			"version": "4",
			"vendor": "photonos-4"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "\u003c 0:6.1.119-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux-6.1",
			"version": "\u003c 0:6.1.119-1~deb11u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux-6.1",
			"version": "\u003c 6.1.119-1~deb11u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux",
			"version": "\u003c 6.11.10-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		},
		{
			"name": "linux",
			"version": "\u003c 6.1.119-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 5.10.232-1.ph4",
			"architecture": "any",
			"manager": "tdnf",
			"vendor": "photon-4"
		}
	],
	"products": [
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.1.119",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.6.63",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.11.10",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc1",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc2",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc3",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc4",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc5",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc6",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.12-rc7",
			"type": "system"
		}
	],
	"programs": [],
	"weaknesses": [
		{
			"name": "CWE-401",
			"impact": "any",
			"scope": "any"
		}
	]
}