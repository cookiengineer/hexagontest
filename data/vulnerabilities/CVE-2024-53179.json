{
	"name": "CVE-2024-53179",
	"description": "In the Linux kernel, the following vulnerability has been resolved:smb: client: fix use-after-free of signing keyCustomers have reported use-after-free in @ses-\u003eauth_key.response withSMB2.1 + sign mounts which occurs due to following race:task A                         task Bcifs_mount() dfs_mount_share()  get_session()   cifs_mount_get_session()    cifs_send_recv()    cifs_get_smb_ses()          compound_send_recv()     cifs_setup_session()        smb2_setup_request()      kfree_sensitive()           smb2_calc_signature()                                   crypto_shash_setkey() *UAF*Fix this by ensuring that we have a valid @ses-\u003eauth_key.response bychecking whether @ses-\u003eses_status is SES_GOOD or SES_EXITING with@ses-\u003eses_lock held.  After commit 24a9799aa8ef (\"smb: client: fix UAFin smb2_reconnect_server()\"), we made sure to call -\u003elogoff() onlywhen @ses was known to be good (e.g. valid -\u003eauth_key.response), soit's safe to access signing key when @ses-\u003eses_status == SES_EXITING.",
	"type": "none",
	"severity": "none",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/0e2b654a3848bf9da3b0d54c1ccf3f1b8c635591",
		"https://git.kernel.org/stable/c/343d7fe6df9e247671440a932b6a73af4fa86d95",
		"https://git.kernel.org/stable/c/39619c65ab4bbb3e78c818f537687653e112764d"
	],
	"datetime": "2025-02-06 12:35:26",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 6.12.3-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-trixie"
		}
	],
	"products": [
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.6.70",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.12.2",
			"type": "system"
		}
	],
	"programs": [],
	"weaknesses": [
		{
			"name": "CWE-416",
			"impact": "any",
			"scope": "any"
		}
	]
}