{
	"name": "CVE-2024-56658",
	"description": "In the Linux kernel, the following vulnerability has been resolved:net: defer final 'struct net' free in netns dismantleIlya reported a slab-use-after-free in dst_destroy [1]Issue is in xfrm6_net_init() and xfrm4_net_init() :They copy xfrm[46]_dst_ops_template into net-\u003exfrm.xfrm[46]_dst_ops.But net structure might be freed before all the dst callbacks arecalled. So when dst_destroy() calls later :if (dst-\u003eops-\u003edestroy)    dst-\u003eops-\u003edestroy(dst);dst-\u003eops points to the old net-\u003exfrm.xfrm[46]_dst_ops, which has been freed.See a relevant issue fixed in :ac888d58869b (\"net: do not delay dst_entries_add() in dst_release()\")A fix is to queue the 'struct net' to be freed after oneanother cleanup_net() round (and existing rcu_barrier())[1]BUG: KASAN: slab-use-after-free in dst_destroy (net/core/dst.c:112)Read of size 8 at addr ffff8882137ccab0 by task swapper/37/0Dec 03 05:46:18 kernel:CPU: 37 UID: 0 PID: 0 Comm: swapper/37 Kdump: loaded Not tainted 6.12.0 #67Hardware name: Red Hat KVM/RHEL, BIOS 1.16.1-1.el9 04/01/2014Call Trace: \u003cIRQ\u003edump_stack_lvl (lib/dump_stack.c:124)print_address_description.constprop.0 (mm/kasan/report.c:378)? dst_destroy (net/core/dst.c:112)print_report (mm/kasan/report.c:489)? dst_destroy (net/core/dst.c:112)? kasan_addr_to_slab (mm/kasan/common.c:37)kasan_report (mm/kasan/report.c:603)? dst_destroy (net/core/dst.c:112)? rcu_do_batch (kernel/rcu/tree.c:2567)dst_destroy (net/core/dst.c:112)rcu_do_batch (kernel/rcu/tree.c:2567)? __pfx_rcu_do_batch (kernel/rcu/tree.c:2491)? lockdep_hardirqs_on_prepare (kernel/locking/lockdep.c:4339 kernel/locking/lockdep.c:4406)rcu_core (kernel/rcu/tree.c:2825)handle_softirqs (kernel/softirq.c:554)__irq_exit_rcu (kernel/softirq.c:589 kernel/softirq.c:428 kernel/softirq.c:637)irq_exit_rcu (kernel/softirq.c:651)sysvec_apic_timer_interrupt (arch/x86/kernel/apic/apic.c:1049 arch/x86/kernel/apic/apic.c:1049) \u003c/IRQ\u003e \u003cTASK\u003easm_sysvec_apic_timer_interrupt (./arch/x86/include/asm/idtentry.h:702)RIP: 0010:default_idle (./arch/x86/include/asm/irqflags.h:37 ./arch/x86/include/asm/irqflags.h:92 arch/x86/kernel/process.c:743)Code: 00 4d 29 c8 4c 01 c7 4c 29 c2 e9 6e ff ff ff 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 66 90 0f 00 2d c7 c9 27 00 fb f4 \u003cfa\u003e c3 cc cc cc cc 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 90RSP: 0018:ffff888100d2fe00 EFLAGS: 00000246RAX: 00000000001870ed RBX: 1ffff110201a5fc2 RCX: ffffffffb61a3e46RDX: 0000000000000000 RSI: 0000000000000000 RDI: ffffffffb3d4d123RBP: 0000000000000000 R08: 0000000000000001 R09: ffffed11c7e1835dR10: ffff888e3f0c1aeb R11: 0000000000000000 R12: 0000000000000000R13: ffff888100d20000 R14: dffffc0000000000 R15: 0000000000000000? ct_kernel_exit.constprop.0 (kernel/context_tracking.c:148)? cpuidle_idle_call (kernel/sched/idle.c:186)default_idle_call (./include/linux/cpuidle.h:143 kernel/sched/idle.c:118)cpuidle_idle_call (kernel/sched/idle.c:186)? __pfx_cpuidle_idle_call (kernel/sched/idle.c:168)? lock_release (kernel/locking/lockdep.c:467 kernel/locking/lockdep.c:5848)? lockdep_hardirqs_on_prepare (kernel/locking/lockdep.c:4347 kernel/locking/lockdep.c:4406)? tsc_verify_tsc_adjust (arch/x86/kernel/tsc_sync.c:59)do_idle (kernel/sched/idle.c:326)cpu_startup_entry (kernel/sched/idle.c:423 (discriminator 1))start_secondary (arch/x86/kernel/smpboot.c:202 arch/x86/kernel/smpboot.c:282)? __pfx_start_secondary (arch/x86/kernel/smpboot.c:232)? soft_restart_cpu (arch/x86/kernel/head_64.S:452)common_startup_64 (arch/x86/kernel/head_64.S:414) \u003c/TASK\u003eDec 03 05:46:18 kernel:Allocated by task 12184:kasan_save_stack (mm/kasan/common.c:48)kasan_save_track (./arch/x86/include/asm/current.h:49 mm/kasan/common.c:60 mm/kasan/common.c:69)__kasan_slab_alloc (mm/kasan/common.c:319 mm/kasan/common.c:345)kmem_cache_alloc_noprof (mm/slub.c:4085 mm/slub.c:4134 mm/slub.c:4141)copy_net_ns (net/core/net_namespace.c:421 net/core/net_namespace.c:480)create_new_namespaces---truncated---",
	"type": "none",
	"severity": "high",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/0f6ede9fbc747e2553612271bce108f7517e7a45",
		"https://git.kernel.org/stable/c/3267b254dc0a04dfa362a2be24573cfa6d2d78f5",
		"https://git.kernel.org/stable/c/6610c7f8a8d47fd1123eed55ba8c11c2444d8842",
		"https://git.kernel.org/stable/c/b7a79e51297f7b82adb687086f5cb2da446f1e40",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-27407.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-41014.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-42252.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-47745.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-49861.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-49926.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-49934.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-50055.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-50121.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-50146.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-50248.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-50258.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-53206.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-56642.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-56658.html",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-56751.html",
		"https://access.redhat.com/security/cve/CVE-2024-27407",
		"https://access.redhat.com/security/cve/CVE-2024-41014",
		"https://access.redhat.com/security/cve/CVE-2024-42252",
		"https://access.redhat.com/security/cve/CVE-2024-47745",
		"https://access.redhat.com/security/cve/CVE-2024-49861",
		"https://access.redhat.com/security/cve/CVE-2024-49926",
		"https://access.redhat.com/security/cve/CVE-2024-49934",
		"https://access.redhat.com/security/cve/CVE-2024-50055",
		"https://access.redhat.com/security/cve/CVE-2024-50121",
		"https://access.redhat.com/security/cve/CVE-2024-50146",
		"https://access.redhat.com/security/cve/CVE-2024-50248",
		"https://access.redhat.com/security/cve/CVE-2024-50258",
		"https://access.redhat.com/security/cve/CVE-2024-53206",
		"https://access.redhat.com/security/cve/CVE-2024-56642",
		"https://access.redhat.com/security/cve/CVE-2024-56658",
		"https://access.redhat.com/security/cve/CVE-2024-56751",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-27407",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-41014",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-42252",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47745",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-49861",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-49926",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-49934",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50055",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50121",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50146",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50248",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50258",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-53206",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-56642",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-56658",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-56751"
	],
	"datetime": "2025-01-22 07:11:00",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		},
		{
			"name": "amazonlinux",
			"version": "2023",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "photonos",
			"version": "5",
			"vendor": "photonos-5"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "\u003c 0:6.1.123-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux",
			"version": "\u003c 6.1.123-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 6.12.6-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		},
		{
			"name": "kernel-libbpf-static",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "python3-perf",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-livepatch",
			"version": "\u003c 6.1.124-134.200-1.0.0.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-tools-debuginfo",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-headers",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "perf",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "perf-debuginfo",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-modules-extra",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-tools-devel",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-libbpf",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "bpftool",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-tools",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-modules-extra-common",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "python3-perf-debuginfo",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "bpftool-debuginfo",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-libbpf-devel",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-debuginfo",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-debuginfo-common-aarch64",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-devel",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "any",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-libbpf-devel",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "python3-perf-debuginfo",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-tools-debuginfo",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-livepatch",
			"version": "\u003c 6.1.124-134.200-1.0.0.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "python3-perf",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "bpftool-debuginfo",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-libbpf",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-headers",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "bpftool",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "perf-debuginfo",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "perf",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-modules-extra",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-tools",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-libbpf-static",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-tools-devel",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-modules-extra-common",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-debuginfo",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-debuginfo-common-x86_64",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "kernel-devel",
			"version": "\u003c 6.1.124.134.200.amzn2023",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "linux",
			"version": "\u003c 6.1.124-1.ph5",
			"architecture": "any",
			"manager": "tdnf",
			"vendor": "photon-5"
		}
	],
	"products": [
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 3.13",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 3.19",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 4.2",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.1.121",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.6.67",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "\u003c 6.12.6",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.13-rc1",
			"type": "system"
		},
		{
			"name": "linux:linux-kernel",
			"vendor": "linux",
			"product": "linux-kernel",
			"version": "6.13-rc2",
			"type": "system"
		}
	],
	"programs": [],
	"weaknesses": [
		{
			"name": "CWE-416",
			"impact": "any",
			"scope": "any"
		}
	]
}