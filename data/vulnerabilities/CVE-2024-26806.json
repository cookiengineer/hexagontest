{
	"name": "CVE-2024-26806",
	"description": "In the Linux kernel, the following vulnerability has been resolved:spi: cadence-qspi: remove system-wide suspend helper calls from runtime PM hooksThe -\u003eruntime_suspend() and -\u003eruntime_resume() callbacks are notexpected to call spi_controller_suspend() and spi_controller_resume().Remove calls to those in the cadence-qspi driver.Those helpers have two roles currently: - They stop/start the queue, including dealing with the kworker. - They toggle the SPI controller SPI_CONTROLLER_SUSPENDED flag. It   requires acquiring ctlr-\u003ebus_lock_mutex.Step one is irrelevant because cadence-qspi is not queued. Step twohowever has two implications: - A deadlock occurs, because -\u003eruntime_resume() is called in a context   where the lock is already taken (in the -\u003eexec_op() callback, where   the usage count is incremented). - It would disallow all operations once the device is auto-suspended.Here is a brief call tree highlighting the mutex deadlock:spi_mem_exec_op()        ...        spi_mem_access_start()                mutex_lock(\u0026ctlr-\u003ebus_lock_mutex)        cqspi_exec_mem_op()                pm_runtime_resume_and_get()                        cqspi_resume()                                spi_controller_resume()                                        mutex_lock(\u0026ctlr-\u003ebus_lock_mutex)                ...        spi_mem_access_end()                mutex_unlock(\u0026ctlr-\u003ebus_lock_mutex)        ...",
	"type": "none",
	"severity": "none",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/041562ebc4759c9932b59a06527f8753b86da365",
		"https://git.kernel.org/stable/c/959043afe53ae80633e810416cee6076da6e91c6"
	],
	"datetime": "2025-02-06 12:35:04",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		},
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "\u003c 6.7.9-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-trixie"
		},
		{
			"name": "linux",
			"version": "\u003c 6.1.123-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 5.10.223-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		}
	],
	"products": [],
	"programs": [],
	"weaknesses": []
}