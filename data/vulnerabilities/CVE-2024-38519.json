{
	"name": "CVE-2024-38519",
	"description": "'yt-dlp' and 'youtube-dl' are command-line audio/video downloaders. Prior to the fixed versions, 'yt-dlp' and 'youtube-dl' do not limit the extensions of downloaded files, which could lead to arbitrary filenames being created in the download folder (and path traversal on Windows). Since 'yt-dlp' and 'youtube-dl' also read config from the working directory (and on Windows executables will be executed from the 'yt-dlp' or 'youtube-dl' directory), this could lead to arbitrary code being executed.'yt-dlp' version 2024.07.01 fixes this issue by whitelisting the allowed extensions. 'youtube-dl' fixes this issue in commit 'd42a222' on the 'master' branch and in nightly builds tagged 2024-07-03 or later. This might mean some very uncommon extensions might not get downloaded, however it will also limit the possible exploitation surface. In addition to upgrading, have '.%(ext)s' at the end of the output template and make sure the user trusts the websites that they are downloading from. Also, make sure to never download to a directory within PATH or other sensitive locations like one's user directory, 'system32', or other binaries locations. For users who are not able to upgrade, keep the default output template ('-o \"%(title)s [%(id)s].%(ext)s'); make sure the extension of the media to download is a common video/audio/sub/... one; try to avoid the generic extractor; and/or use '--ignore-config --config-location ...' to not load config from common locations.",
	"type": "none",
	"severity": "medium",
	"state": "published",
	"references": [
		"https://github.com/dirkf/youtube-dl/security/advisories/GHSA-22fp-mf44-f2mq",
		"https://github.com/yt-dlp/yt-dlp/commit/5ce582448ececb8d9c30c8c31f58330090ced03a",
		"https://github.com/yt-dlp/yt-dlp/releases/tag/2024.07.01",
		"https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4j",
		"https://github.com/ytdl-org/youtube-dl/commit/d42a222ed541b96649396ef00e19552aef0f09ec",
		"https://github.com/ytdl-org/youtube-dl/pull/32830",
		"https://securitylab.github.com/advisories/GHSL-2024-089_youtube-dl/",
		"https://securitylab.github.com/advisories/GHSL-2024-090_yt-dlp",
		"https://nvd.nist.gov/vuln/detail/CVE-2023-35934",
		"https://nvd.nist.gov/vuln/detail/CVE-2023-46121",
		"https://nvd.nist.gov/vuln/detail/CVE-2024-38519",
		"https://www.cve.org/CVERecord?id=CVE-2024-38519"
	],
	"datetime": "2024-09-28 00:00:00",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "gentoolinux",
			"version": "any",
			"vendor": "gentoolinux"
		},
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		},
		{
			"name": "ubuntu",
			"version": "focal",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "ubuntu",
			"version": "jammy",
			"vendor": "ubuntu-jammy"
		},
		{
			"name": "ubuntu",
			"version": "mantic",
			"vendor": "ubuntu-mantic"
		},
		{
			"name": "ubuntu",
			"version": "noble",
			"vendor": "ubuntu-noble"
		},
		{
			"name": "ubuntu",
			"version": "oracular",
			"vendor": "ubuntu-oracular"
		},
		{
			"name": "linuxmint",
			"version": "ulyana",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "linuxmint",
			"version": "una",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "linuxmint",
			"version": "ulyssa",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "linuxmint",
			"version": "uma",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "linuxmint",
			"version": "vanessa",
			"vendor": "ubuntu-jammy"
		},
		{
			"name": "linuxmint",
			"version": "victoria",
			"vendor": "ubuntu-jammy"
		},
		{
			"name": "linuxmint",
			"version": "vera",
			"vendor": "ubuntu-jammy"
		},
		{
			"name": "trisquel",
			"version": "nabia",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "trisquel",
			"version": "aramo",
			"vendor": "ubuntu-jammy"
		}
	],
	"packages": [
		{
			"name": "net-misc/yt-dlp",
			"version": "\u003c 2024.07.01",
			"architecture": "any",
			"manager": "any",
			"vendor": "gentoolinux"
		},
		{
			"name": "youtube-dl",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "yt-dlp",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "yt-dlp",
			"version": "\u003c 2024.07.01-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		}
	],
	"products": [],
	"programs": [],
	"weaknesses": [
		{
			"name": "CWE-669",
			"impact": "any",
			"scope": "any"
		}
	]
}