{
	"name": "CVE-2024-47191",
	"description": "Fabian Vogt reported that the PAM module in oath-toolkit, a collection of components to build one-time password authentication systems, does not safely perform file operations in  users's home directories when using the usersfile feature (allowing to place the OTP state in the home directory of the to-be-authenticated user). A local user can take advantage of this flaw for root privilege escalation.",
	"type": "none",
	"severity": "high",
	"state": "published",
	"references": [
		"https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/3235a52f6b87cd1c5da6508f421ac261f5e33a70",
		"https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/3271139989fde35ab0163b558fc29e80c3a280e5",
		"https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/60d9902b5c20f27e70f8e9c816bfdc0467567e1a",
		"https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/95ef255e6a401949ce3f67609bf8aac2029db418",
		"https://gitlab.com/oath-toolkit/oath-toolkit/-/issues/43",
		"https://security.opensuse.org/2024/10/04/oath-toolkit-vulnerability.html",
		"https://www.nongnu.org/oath-toolkit/security/CVE-2024-47191",
		"https://www.openwall.com/lists/oss-security/2024/10/04/2",
		"https://www.nongnu.org/oath-toolkit/security/CVE-2024-47191/",
		"https://nvd.nist.gov/vuln/detail/CVE-2024-47191",
		"https://www.cve.org/CVERecord?id=CVE-2024-47191",
		"https://ubuntu.com/security/notices/USN-7059-1",
		"https://ubuntu.com/security/notices/USN-7059-2",
		"https://alas.aws.amazon.com/cve/html/CVE-2024-47191.html",
		"https://access.redhat.com/security/cve/CVE-2024-47191",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47191"
	],
	"datetime": "2024-10-04 00:00:00",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "archlinux",
			"version": "any",
			"vendor": "archlinux"
		},
		{
			"name": "gentoolinux",
			"version": "any",
			"vendor": "gentoolinux"
		},
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "ubuntu",
			"version": "bionic",
			"vendor": "ubuntu-bionic"
		},
		{
			"name": "ubuntu",
			"version": "focal",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "ubuntu",
			"version": "jammy",
			"vendor": "ubuntu-jammy"
		},
		{
			"name": "ubuntu",
			"version": "noble",
			"vendor": "ubuntu-noble"
		},
		{
			"name": "ubuntu",
			"version": "oracular",
			"vendor": "ubuntu-oracular"
		},
		{
			"name": "ubuntu",
			"version": "xenial",
			"vendor": "ubuntu-xenial"
		},
		{
			"name": "amazonlinux",
			"version": "2023",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "cblmariner",
			"version": "2",
			"vendor": "cblmariner-2"
		},
		{
			"name": "manjaro",
			"version": "any",
			"vendor": "archlinux"
		},
		{
			"name": "linuxmint",
			"version": "ulyana",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "linuxmint",
			"version": "una",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "linuxmint",
			"version": "ulyssa",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "linuxmint",
			"version": "uma",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "linuxmint",
			"version": "vanessa",
			"vendor": "ubuntu-jammy"
		},
		{
			"name": "linuxmint",
			"version": "victoria",
			"vendor": "ubuntu-jammy"
		},
		{
			"name": "linuxmint",
			"version": "vera",
			"vendor": "ubuntu-jammy"
		},
		{
			"name": "linuxmint",
			"version": "serena",
			"vendor": "ubuntu-xenial"
		},
		{
			"name": "linuxmint",
			"version": "sylvia",
			"vendor": "ubuntu-xenial"
		},
		{
			"name": "linuxmint",
			"version": "sarah",
			"vendor": "ubuntu-xenial"
		},
		{
			"name": "linuxmint",
			"version": "sonya",
			"vendor": "ubuntu-xenial"
		},
		{
			"name": "linuxmint",
			"version": "tessa",
			"vendor": "ubuntu-bionic"
		},
		{
			"name": "linuxmint",
			"version": "tina",
			"vendor": "ubuntu-bionic"
		},
		{
			"name": "linuxmint",
			"version": "tara",
			"vendor": "ubuntu-bionic"
		},
		{
			"name": "linuxmint",
			"version": "tricia",
			"vendor": "ubuntu-bionic"
		},
		{
			"name": "trisquel",
			"version": "flidas",
			"vendor": "ubuntu-xenial"
		},
		{
			"name": "trisquel",
			"version": "etiona",
			"vendor": "ubuntu-bionic"
		},
		{
			"name": "trisquel",
			"version": "nabia",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "trisquel",
			"version": "aramo",
			"vendor": "ubuntu-jammy"
		},
		{
			"name": "antergos",
			"version": "any",
			"vendor": "archlinux"
		}
	],
	"packages": [
		{
			"name": "oath-toolkit",
			"version": "\u003c 2.6.12-1",
			"architecture": "any",
			"manager": "pacman",
			"vendor": "archlinux"
		},
		{
			"name": "sys-auth/oath-toolkit",
			"version": "\u003c 2.6.12",
			"architecture": "any",
			"manager": "any",
			"vendor": "gentoolinux"
		},
		{
			"name": "oath-toolkit",
			"version": "\u003c 0:2.6.7-3.1+deb12u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "oath-toolkit",
			"version": "\u003c 2.6.12-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-trixie"
		},
		{
			"name": "oath-toolkit",
			"version": "\u003c 2.6.7-3.1+deb12u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "oath-toolkit",
			"version": "\u003c 2.6.6-3",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "oath-toolkit",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-bionic"
		},
		{
			"name": "oath-toolkit",
			"version": "\u003c 2.6.7-3ubuntu0.1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-jammy"
		},
		{
			"name": "oath-toolkit",
			"version": "\u003c 2.6.11-2.1ubuntu0.1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-noble"
		},
		{
			"name": "oath-toolkit",
			"version": "\u003c 2.6.11-3ubuntu1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-oracular"
		},
		{
			"name": "libpskc-debuginfo",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "oath-toolkit-debuginfo",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "oath-toolkit-debugsource",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "libpskc-devel",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "pskctool-debuginfo",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "pskctool",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "oathtool-debuginfo",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "libpskc",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "pam_oath",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "liboath",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "oathtool",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "liboath-devel",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "liboath-debuginfo",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "pam_oath-debuginfo",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "armv8",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "libpskc-doc",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "any",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "liboath-doc",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "any",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "oath-toolkit",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "any",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "oathtool-debuginfo",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "oath-toolkit-debugsource",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "pskctool",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "libpskc-devel",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "pam_oath-debuginfo",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "libpskc-debuginfo",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "liboath",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "liboath-devel",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "pskctool-debuginfo",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "oathtool",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "oath-toolkit-debuginfo",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "liboath-debuginfo",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "pam_oath",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "libpskc",
			"version": "\u003c 2.6.12.1.amzn2023.0.1",
			"architecture": "x86_64",
			"manager": "dnf",
			"vendor": "amazonlinux-2023"
		},
		{
			"name": "oath-toolkit",
			"version": "\u003c 0:2.6.7-3.",
			"architecture": "any",
			"manager": "apt",
			"vendor": "cblmariner-2"
		}
	],
	"products": [],
	"programs": [],
	"weaknesses": [
		{
			"name": "CWE-22",
			"impact": "any",
			"scope": "any"
		}
	]
}