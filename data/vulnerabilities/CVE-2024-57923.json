{
	"name": "CVE-2024-57923",
	"description": "In the Linux kernel, the following vulnerability has been resolved:btrfs: zlib: fix avail_in bytes for s390 zlib HW compression pathSince the input data length passed to zlib_compress_folios() can bearbitrary, always setting strm.avail_in to a multiple of PAGE_SIZE maycause read-in bytes to exceed the input range. Currently this triggersan assert in btrfs_compress_folios() on the debug kernel (see below).Fix strm.avail_in calculation for S390 hardware acceleration path.  assertion failed: *total_in \u003c= orig_len, in fs/btrfs/compression.c:1041  ------------[ cut here ]------------  kernel BUG at fs/btrfs/compression.c:1041!  monitor event: 0040 ilc:2 [#1] PREEMPT SMP  CPU: 16 UID: 0 PID: 325 Comm: kworker/u273:3 Not tainted 6.13.0-20241204.rc1.git6.fae3b21430ca.300.fc41.s390x+debug #1  Hardware name: IBM 3931 A01 703 (z/VM 7.4.0)  Workqueue: btrfs-delalloc btrfs_work_helper  Krnl PSW : 0704d00180000000 0000021761df6538 (btrfs_compress_folios+0x198/0x1a0)             R:0 T:1 IO:1 EX:1 Key:0 M:1 W:0 P:0 AS:3 CC:1 PM:0 RI:0 EA:3  Krnl GPRS: 0000000080000000 0000000000000001 0000000000000047 0000000000000000             0000000000000006 ffffff01757bb000 000001976232fcc0 000000000000130c             000001976232fcd0 000001976232fcc8 00000118ff4a0e30 0000000000000001             00000111821ab400 0000011100000000 0000021761df6534 000001976232fb58  Krnl Code: 0000021761df6528: c020006f5ef4        larl    %r2,0000021762be2310             0000021761df652e: c0e5ffbd09d5        brasl   %r14,00000217615978d8            #0000021761df6534: af000000            mc      0,0            \u003e0000021761df6538: 0707                bcr     0,%r7             0000021761df653a: 0707                bcr     0,%r7             0000021761df653c: 0707                bcr     0,%r7             0000021761df653e: 0707                bcr     0,%r7             0000021761df6540: c004004bb7ec        brcl    0,000002176276d518  Call Trace:   [\u003c0000021761df6538\u003e] btrfs_compress_folios+0x198/0x1a0  ([\u003c0000021761df6534\u003e] btrfs_compress_folios+0x194/0x1a0)   [\u003c0000021761d97788\u003e] compress_file_range+0x3b8/0x6d0   [\u003c0000021761dcee7c\u003e] btrfs_work_helper+0x10c/0x160   [\u003c0000021761645760\u003e] process_one_work+0x2b0/0x5d0   [\u003c000002176164637e\u003e] worker_thread+0x20e/0x3e0   [\u003c000002176165221a\u003e] kthread+0x15a/0x170   [\u003c00000217615b859c\u003e] __ret_from_fork+0x3c/0x60   [\u003c00000217626e72d2\u003e] ret_from_fork+0xa/0x38  INFO: lockdep is turned off.  Last Breaking-Event-Address:   [\u003c0000021761597924\u003e] _printk+0x4c/0x58  Kernel panic - not syncing: Fatal exception: panic_on_oops",
	"type": "none",
	"severity": "none",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/0ee4736c003daded513de0ff112d4a1e9c85bbab",
		"https://git.kernel.org/stable/c/25adbb08aeadcff883ab801df99fd20fefbb6ca4"
	],
	"datetime": "2025-02-06 12:35:29",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "\u003c 6.1.123-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 5.10.223-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux",
			"version": "\u003c 6.12.10-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		}
	],
	"products": [],
	"programs": [],
	"weaknesses": []
}