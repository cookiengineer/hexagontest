{
	"name": "CVE-2024-26807",
	"description": "In the Linux kernel, the following vulnerability has been resolved:Both cadence-quadspi -\u003eruntime_suspend() and -\u003eruntime_resume()implementations start with:    struct cqspi_st *cqspi = dev_get_drvdata(dev);    struct spi_controller *host = dev_get_drvdata(dev);This obviously cannot be correct, unless \"struct cqspi_st\" is thefirst member of \" struct spi_controller\", or the other way around, butit is not the case. \"struct spi_controller\" is allocated bydevm_spi_alloc_host(), which allocates an extra amount of memory forprivate data, used to store \"struct cqspi_st\".The -\u003eprobe() function of the cadence-quadspi driver then sets thedevice drvdata to store the address of the \"struct cqspi_st\"structure. Therefore:    struct cqspi_st *cqspi = dev_get_drvdata(dev);is correct, but:    struct spi_controller *host = dev_get_drvdata(dev);is not, as it makes \"host\" point not to a \"struct spi_controller\" butto the same \"struct cqspi_st\" structure as above.This obviously leads to bad things (memory corruption, kernel crashes)directly during -\u003eprobe(), as -\u003eprobe() enables the device using PMruntime, leading the -\u003eruntime_resume() hook being called, which inturns calls spi_controller_resume() with the wrong pointer.This has at least been reported [0] to cause a kernel crash, but theexact behavior will depend on the memory contents.[0] https://lore.kernel.org/all/20240226121803.5a7r5wkpbbowcxgx@dhruva/This issue potentially affects all platforms that are currently usingthe cadence-quadspi driver.",
	"type": "none",
	"severity": "none",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/03f1573c9587029730ca68503f5062105b122f61",
		"https://git.kernel.org/stable/c/32ce3bb57b6b402de2aec1012511e7ac4e7449dc",
		"https://git.kernel.org/stable/c/34e1d5c4407c78de0e3473e1fbf8fb74dbe66d03"
	],
	"datetime": "2025-02-06 12:35:04",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 6.7.9-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		}
	],
	"products": [],
	"programs": [],
	"weaknesses": []
}