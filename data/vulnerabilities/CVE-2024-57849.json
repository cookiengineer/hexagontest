{
	"name": "CVE-2024-57849",
	"description": "In the Linux kernel, the following vulnerability has been resolved:s390/cpum_sf: Handle CPU hotplug remove during samplingCPU hotplug remove handling triggers the following functioncall sequence:   CPUHP_AP_PERF_S390_SF_ONLINE  --\u003e s390_pmu_sf_offline_cpu()   ...   CPUHP_AP_PERF_ONLINE          --\u003e perf_event_exit_cpu()The s390 CPUMF sampling CPU hotplug handler invokes: s390_pmu_sf_offline_cpu() +--\u003e  cpusf_pmu_setup()       +--\u003e setup_pmc_cpu()            +--\u003e deallocate_buffers()This function de-allocates all sampling data buffers (SDBs) allocatedfor that CPU at event initialization. It also clears thePMU_F_RESERVED bit. The CPU is gone and can not be sampled.With the event still being active on the removed CPU, the CPU eventhotplug support in kernel performance subsystem triggers thefollowing function calls on the removed CPU:  perf_event_exit_cpu()  +--\u003e perf_event_exit_cpu_context()       +--\u003e __perf_event_exit_context()        +--\u003e __perf_remove_from_context()             +--\u003e event_sched_out()                  +--\u003e cpumsf_pmu_del()                       +--\u003e cpumsf_pmu_stop()                                +--\u003e hw_perf_event_update()to stop and remove the event. During removal of the event, thesampling device driver tries to read out the remaining samples fromthe sample data buffers (SDBs). But they have already been freed(and may have been re-assigned). This may lead to a use after freesituation in which case the samples are most likely invalid. In thebest case the memory has not been reassigned and still containsvalid data.Remedy this situation and check if the CPU is still in reservedstate (bit PMU_F_RESERVED set). In this case the SDBs have not beenreleased an contain valid data. This is always the case whenthe event is removed (and no CPU hotplug off occured).If the PMU_F_RESERVED bit is not set, the SDB buffers are gone.",
	"type": "none",
	"severity": "none",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/06a92f810df8037ca36157282ddcbefdcaf049b8",
		"https://git.kernel.org/stable/c/238e3af849dfdcb1faed544349f7025e533f9aab",
		"https://git.kernel.org/stable/c/99192c735ed4bfdff0d215ec85c8a87a677cb898",
		"https://git.kernel.org/stable/c/a0bd7dacbd51c632b8e2c0500b479af564afadf3",
		"https://git.kernel.org/stable/c/a69752f1e5de817941a2ea0609254f6f25acd274",
		"https://git.kernel.org/stable/c/b5be6a0bb639d165c8418d8dddd8f322587be8be",
		"https://git.kernel.org/stable/c/be54e6e0f93a39a9c00478d70d12956a5f3d5b9b"
	],
	"datetime": "2025-02-06 12:35:28",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "\u003c 0:6.1.123-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux",
			"version": "\u003c 6.1.123-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 6.12.5-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		}
	],
	"products": [],
	"programs": [],
	"weaknesses": []
}