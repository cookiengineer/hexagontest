{
	"name": "CVE-2024-26748",
	"description": "In the Linux kernel, the following vulnerability has been resolved:usb: cdns3: fix memory double free when handle zero packet829  if (request-\u003ecomplete) {830          spin_unlock(\u0026priv_dev-\u003elock);831          usb_gadget_giveback_request(\u0026priv_ep-\u003eendpoint,832                                    request);833          spin_lock(\u0026priv_dev-\u003elock);834  }835836  if (request-\u003ebuf == priv_dev-\u003ezlp_buf)837      cdns3_gadget_ep_free_request(\u0026priv_ep-\u003eendpoint, request);Driver append an additional zero packet request when queue a packet, whichlength mod max packet size is 0. When transfer complete, run to line 831,usb_gadget_giveback_request() will free this requestion. 836 condition istrue, so cdns3_gadget_ep_free_request() free this request again.Log:[ 1920.140696][  T150] BUG: KFENCE: use-after-free read in cdns3_gadget_giveback+0x134/0x2c0 [cdns3][ 1920.140696][  T150][ 1920.151837][  T150] Use-after-free read at 0x000000003d1cd10b (in kfence-#36):[ 1920.159082][  T150]  cdns3_gadget_giveback+0x134/0x2c0 [cdns3][ 1920.164988][  T150]  cdns3_transfer_completed+0x438/0x5f8 [cdns3]Add check at line 829, skip call usb_gadget_giveback_request() if it isadditional zero length packet request. Needn't callusb_gadget_giveback_request() because it is allocated in this driver.",
	"type": "none",
	"severity": "high",
	"state": "published",
	"references": [
		"https://git.kernel.org/stable/c/1e204a8e9eb514e22a6567fb340ebb47df3f3a48",
		"https://git.kernel.org/stable/c/3a2a909942b5335b7ea66366d84261b3ed5f89c8",
		"https://git.kernel.org/stable/c/5fd9e45f1ebcd57181358af28506e8a661a260b3",
		"https://git.kernel.org/stable/c/70e8038813f9d3e72df966748ebbc40efe466019",
		"https://git.kernel.org/stable/c/92d20406a3d4ff3e8be667c79209dc9ed31df5b3",
		"https://git.kernel.org/stable/c/9a52b694b066f299d8b9800854a8503457a8b64c",
		"https://git.kernel.org/stable/c/aad6132ae6e4809e375431f8defd1521985e44e7",
		"https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html"
	],
	"datetime": "2024-05-06 00:00:00",
	"connections": [],
	"devices": [],
	"distributions": [
		{
			"name": "debian",
			"version": "bookworm",
			"vendor": "debian-bookworm"
		},
		{
			"name": "debian",
			"version": "bullseye",
			"vendor": "debian-bullseye"
		},
		{
			"name": "debian",
			"version": "trixie",
			"vendor": "debian-trixie"
		},
		{
			"name": "debian",
			"version": "sid",
			"vendor": "debian-sid"
		},
		{
			"name": "photonos",
			"version": "4",
			"vendor": "photonos-4"
		}
	],
	"packages": [
		{
			"name": "linux",
			"version": "\u003c 0:6.1.82-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 0:5.10.216-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux",
			"version": "\u003c 6.7.7-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-trixie"
		},
		{
			"name": "linux",
			"version": "\u003c 6.1.82-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "linux",
			"version": "\u003c 5.10.216-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "linux",
			"version": "\u003c 5.10.46-2.ph4",
			"architecture": "any",
			"manager": "tdnf",
			"vendor": "photon-4"
		}
	],
	"products": [],
	"programs": [],
	"weaknesses": []
}